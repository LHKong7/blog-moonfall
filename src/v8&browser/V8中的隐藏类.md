## V8中的隐藏类 （hidden class）
由于在静态语言中，可以直接通过偏移量来查询对象的属性值，效率会很高；

在JavaScript这种动态类型语言如何提高查询效率，V8通过定义隐藏类（hidden class）来实现这一特性：将JavaScript中的对象静态化，也就是V8在运行JavaScript的过程中，会假设JavaScript对象时静态的：
- 对象创建好了之后就不会添加新的属性；
- 对象创建好了之后也不会删除属性。
有了隐藏类，那么当 V8 访问某个对象中的某个属性时，就会先去隐藏类中查找该属性相对于它的对象的偏移量，有了偏移量和属性类型，V8 就可以直接去内存中取出对于的属性值，而不需要经历一系列的查找过程，那么这就大大提升了 V8 查找对象的效率。隐藏类描述了对象的属性布局，它主要包括了属性名称和每个属性所对应的偏移量，比如 point 对象的隐藏类就包括了 x 和 y 属性，x 的偏移量是 4，y 的偏移量是 8。

```js
let point = {x:100,y:200}
```
当 V8 执行到这段代码时，会先为 point 对象创建一个隐藏类，在 V8 中，把隐藏类又称为 map，每个对象都有一个 map 属性，其值指向内存中的隐藏类。

现在我们知道了在 V8 中，每个对象都有一个 map 属性，该属性值指向该对象的隐藏类。不过如果两个对象的形状是相同的，V8 就会为其复用同一个隐藏类，这样有两个好处：
- 减少隐藏类的创建次数，也间接加速了代码的执行速度；
- 减少了隐藏类的存储空间。
什么情况下两个对象的形状是相同的，要满足以下两点：
- 相同的属性名称；
- 相等的属性个数。

**何时隐藏类重构**： 给一个对象添加新的属性，删除新的属性，或者改变某个属性的数据类型都会改变这个对象的形状，那么势必也就会触发 V8 为改变形状后的对象重建新的隐藏类。


我们当然希望对象中的隐藏类不要随便被改变，因为这样会触发 V8 重构该对象的隐藏类，直接影响到了程序的执行性能。那么在实际工作中，我们应该尽量注意以下几点：
1. 使用字面量初始化对象时，要保证属性的顺序是一致的。
2. 尽量使用字面量一次性初始化完整对象属性。因为每次为对象添加一个属性时，V8 都会为该对象重新设置隐藏类。
3. 尽量避免使用 delete 方法。delete 方法会破坏对象的形状，同样会导致 V8 为该对象重新生成新的隐藏类。

